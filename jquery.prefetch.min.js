/*!
 * jQuery Prefetch - min - v0.1.1
 * http://jquery.eisbehr.de/prefetch/
 * http://eisbehr.de
 *
 * Copyright 2015, Daniel 'Eisbehr' Kern
 *
 * Dual licensed under the MIT and GPL-2.0 licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl-2.0.html
 *
 * jQuery.prefetch(["image1.jpg", "image2.jpg", ...], {delay: 1000});
 * jQuery("img").prefetch();
 */
!function(t){"use strict";function n(n,i){return i&&t.extend(this.configuration,i),this.addImage(n),this._initialize()}t.Prefetch=t.prefetch=function(t,i){return new n(t,i)},t.fn.Prefetch=t.fn.prefetch=function(n){var i=t.prefetch(this,n);return i.configuration.chainable?this:i},t.extend(n.prototype,{_images:[],_running:!1,_runningAmount:0,configuration:{chainable:!0,startAutomatically:!0,delay:0,simultaneous:3,objectProperty:"url",onStartLoading:null,onImageLoaded:null,onImageError:null,onAbortLoading:null,onAllLoaded:null},_initialize:function(){var t=this;return this.configuration.startAutomatically&&setTimeout(function(){t.start()},this.configuration.delay),this},_checkForNextImage:function(){if(this._running&&!(this.configuration.simultaneous>0&&this._runningAmount>=this.configuration.simultaneous)){for(var t=!1,n=0;n<this._images.length;++n)if(!this._images[n].running&&!this._images[n].loaded){t=!0,this._preloadImage(this._images[n]);break}t||this.getLoadedAmount()!=this.getImagesAmount()||(this._running=!1,this._triggerCallback(this.configuration.onAllLoaded))}},_preloadImage:function(n){n.running=!0,++this._runningAmount;var i=this,e=t(new Image);e.error(function(){i._finishImage(n,!1)}),e.one("load",function(){e.unbind("load").remove(),i._finishImage(n,!0)}),e.attr("src",n.url),e.complete&&e.load()},_finishImage:function(t,n){t.loaded=!0,t.running=!1,--this._runningAmount,n?this._triggerCallback(this.configuration.onImageLoaded,t.url):this._triggerCallback(this.configuration.onImageError,t.url),this._checkForNextImage()},_triggerCallback:function(t,n){t&&(n?t(n,this):t(this))},start:function(){if(!this._running&&this.getLoadedAmount()<this.getImagesAmount()){this._running=!0,this._triggerCallback(this.configuration.onStartLoading);for(var t=this._runningAmount;(this.configuration.simultaneous<=0||t<this.configuration.simultaneous)&&t<this._images.length;t++)this._checkForNextImage()}return this},stop:function(){return this._running&&(this._running=!1,this._triggerCallback(this.configuration.onAbortLoading)),this},getImagesAmount:function(){return this._images.length},getLoadedAmount:function(){for(var t=0,n=0;n<this._images.length;++n)n in this._images&&this._images[n].loaded&&++t;return t},addImage:function(n){var i={url:"",running:!1,loaded:!1},e=Object.prototype.toString.call(n);if("[object Array]"==e)for(var r=0;r<n.length;++r)r in n&&this._images.push(jQuery.extend({},i,{url:n[r].url||n[r]}));else if("[object Object]"==e){var o=this;t.each(n,function(){var n=t(this);(this.hasOwnProperty(o.configuration.objectProperty)||n.attr("src")||n.css("background-image"))&&o._images.push(jQuery.extend({},i,{url:this[o.configuration.objectProperty]||n.attr("src")||n.css("background-image").replace(/^url\(["']?/,"").replace(/["']?\)$/,"")}))})}else"[object String]"==e&&this._images.push(jQuery.extend({},i,{url:n}));return this},destroy:function(){return this.stop(),this._images=[],this}})}(jQuery);